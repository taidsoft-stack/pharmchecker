schemaname,tablename,policyname,permissive,roles,cmd,qual,with_check
public,admin_activity_logs,Admin read activity logs,PERMISSIVE,{public},SELECT,"(EXISTS ( SELECT 1
   FROM admins
  WHERE ((admins.admin_id = auth.uid()) AND (admins.is_active = true))))",null
public,admin_sessions,Admin read own sessions,PERMISSIVE,{public},SELECT,(admin_id = auth.uid()),null
public,admin_user_memos,Admin manage user memos,PERMISSIVE,{public},ALL,"(EXISTS ( SELECT 1
   FROM admins
  WHERE ((admins.admin_id = auth.uid()) AND (admins.is_active = true))))",null
public,admins,Admin read self,PERMISSIVE,{public},SELECT,(admin_id = auth.uid()),null
public,admins,Super admin manage admins,PERMISSIVE,{public},ALL,"(EXISTS ( SELECT 1
   FROM admins admins_1
  WHERE ((admins_1.admin_id = auth.uid()) AND (admins_1.role = 'super_admin'::text) AND (admins_1.is_active = true))))",null
public,billing_payments,Service role can access all payments,PERMISSIVE,{service_role},ALL,true,true
public,doctors,tenant_rls_doctors,PERMISSIVE,{public},ALL,(tenant_id = auth.uid()),null
public,drugs,tenant_rls_drugs,PERMISSIVE,{public},ALL,(tenant_id = auth.uid()),null
public,faqs,Anyone can read active FAQs,PERMISSIVE,{public},SELECT,(is_active = true),null
public,faqs,Service role can manage all FAQs,PERMISSIVE,{service_role},ALL,true,true
public,patient_drugs,tenant_rls_patient_drugs,PERMISSIVE,{public},ALL,(tenant_id = auth.uid()),null
public,patients,tenant_rls_patients,PERMISSIVE,{public},ALL,(tenant_id = auth.uid()),null
public,payment_methods,Service role can access all payment methods,PERMISSIVE,{service_role},ALL,true,true
public,pending_user_promotions,Service role can access promotions,PERMISSIVE,{service_role},ALL,true,true
public,promotion_usage_history,Admin manage promotion usage history,PERMISSIVE,{public},ALL,"(EXISTS ( SELECT 1
   FROM admins a
  WHERE ((a.admin_id = auth.uid()) AND (a.is_active = true))))",null
public,promotion_usage_history,No direct access for users,PERMISSIVE,{public},ALL,false,null
public,promotion_usage_history,Service role full access,PERMISSIVE,{service_role},ALL,true,true
public,remote_support_sessions,Admin cannot insert remote support session,PERMISSIVE,{public},INSERT,null,false
public,remote_support_sessions,Admin manage remote support,PERMISSIVE,{public},ALL,"(EXISTS ( SELECT 1
   FROM admins a
  WHERE ((a.admin_id = auth.uid()) AND (a.is_active = true))))",null
public,remote_support_sessions,Admin manage remote support sessions,PERMISSIVE,{public},ALL,"(EXISTS ( SELECT 1
   FROM admins
  WHERE ((admins.admin_id = auth.uid()) AND (admins.is_active = true))))",null
public,remote_support_sessions,User can create remote support session,PERMISSIVE,{public},INSERT,null,((user_id = auth.uid()) AND (status = 'requested'::text))
public,remote_support_sessions,User can insert own remote sessions,PERMISSIVE,{public},INSERT,null,((user_id = auth.uid()) AND is_active_user())
public,remote_support_sessions,User can read own remote sessions,PERMISSIVE,{public},SELECT,((user_id = auth.uid()) AND is_active_user()),null
public,remote_support_sessions,User can read own remote support sessions,PERMISSIVE,{public},SELECT,(user_id = auth.uid()),null
public,remote_support_sessions,User cannot update remote support session,PERMISSIVE,{public},UPDATE,false,null
public,remote_support_sessions,User create remote support session,PERMISSIVE,{public},INSERT,null,((user_id = auth.uid()) AND (status = 'requested'::text))
public,rxheads,tenant_rls_rxheads,PERMISSIVE,{public},ALL,(tenant_id = auth.uid()),null
public,rxrecipe_details,tenant_rls_rxrecipe_details,PERMISSIVE,{public},ALL,(tenant_id = auth.uid()),null
public,rxrecipes,tenant_rls_rxrecipes,PERMISSIVE,{public},ALL,(tenant_id = auth.uid()),null
public,subscription_plans,Anyone can view subscription plans,PERMISSIVE,{public},SELECT,(is_active = true),null
public,subscription_plans,Service role can manage subscription plans,PERMISSIVE,{service_role},ALL,true,true
public,subscription_promotions,Service role can access subscription promotions,PERMISSIVE,{service_role},ALL,true,true
public,support_attachments,Admin can delete attachments,PERMISSIVE,{public},DELETE,"(EXISTS ( SELECT 1
   FROM admins a
  WHERE ((a.admin_id = auth.uid()) AND (a.is_active = true))))",null
public,support_attachments,Admin can read all attachments,PERMISSIVE,{public},SELECT,"(EXISTS ( SELECT 1
   FROM admins a
  WHERE ((a.admin_id = auth.uid()) AND (a.is_active = true))))",null
public,support_attachments,Admin can upload reply attachments,PERMISSIVE,{public},INSERT,null,"((reply_id IS NOT NULL) AND (uploaded_by = 'admin'::text) AND (EXISTS ( SELECT 1
   FROM admins a
  WHERE ((a.admin_id = auth.uid()) AND (a.is_active = true)))))"
public,support_attachments,Admin manage attachments,PERMISSIVE,{public},ALL,"(EXISTS ( SELECT 1
   FROM admins
  WHERE ((admins.admin_id = auth.uid()) AND (admins.is_active = true))))",null
public,support_attachments,User can read own attachments,PERMISSIVE,{public},SELECT,"((ticket_id IN ( SELECT support_tickets.ticket_id
   FROM support_tickets
  WHERE (support_tickets.user_id = auth.uid()))) AND is_active_user())",null
public,support_attachments,User can read own ticket attachments,PERMISSIVE,{public},SELECT,"((reply_id IS NULL) AND (ticket_id IN ( SELECT t.ticket_id
   FROM support_tickets t
  WHERE (t.user_id = auth.uid()))) AND (EXISTS ( SELECT 1
   FROM users u
  WHERE ((u.user_id = auth.uid()) AND (u.is_deleted = false)))))",null
public,support_attachments,User can upload attachment,PERMISSIVE,{public},INSERT,null,"(ticket_id IN ( SELECT support_tickets.ticket_id
   FROM support_tickets
  WHERE (support_tickets.user_id = auth.uid())))"
public,support_attachments,User can upload ticket attachments,PERMISSIVE,{public},INSERT,null,"((reply_id IS NULL) AND (uploaded_by = 'user'::text) AND (ticket_id IN ( SELECT t.ticket_id
   FROM support_tickets t
  WHERE (t.user_id = auth.uid()))) AND (EXISTS ( SELECT 1
   FROM users u
  WHERE ((u.user_id = auth.uid()) AND (u.is_deleted = false)))))"
public,support_attachments,User cannot update attachments,PERMISSIVE,{public},UPDATE,false,null
public,support_attachments,User read own attachments,PERMISSIVE,{public},SELECT,"(ticket_id IN ( SELECT support_tickets.ticket_id
   FROM support_tickets
  WHERE (support_tickets.user_id = auth.uid())))",null
public,support_attachments,User upload attachment,PERMISSIVE,{public},INSERT,null,"(ticket_id IN ( SELECT support_tickets.ticket_id
   FROM support_tickets
  WHERE (support_tickets.user_id = auth.uid())))"
public,support_replies,Admin create reply,PERMISSIVE,{public},INSERT,null,"(EXISTS ( SELECT 1
   FROM admins a
  WHERE ((a.admin_id = auth.uid()) AND (a.is_active = true))))"
public,support_replies,Admin manage replies,PERMISSIVE,{public},ALL,"(EXISTS ( SELECT 1
   FROM admins
  WHERE ((admins.admin_id = auth.uid()) AND (admins.is_active = true))))",null
public,support_replies,User can read public replies,PERMISSIVE,{public},SELECT,"((is_public = true) AND (ticket_id IN ( SELECT support_tickets.ticket_id
   FROM support_tickets
  WHERE (support_tickets.user_id = auth.uid()))) AND is_active_user())",null
public,support_replies,User read public replies,PERMISSIVE,{public},SELECT,"((is_public = true) AND (ticket_id IN ( SELECT support_tickets.ticket_id
   FROM support_tickets
  WHERE (support_tickets.user_id = auth.uid()))))",null
public,support_tickets,Admin full access,PERMISSIVE,{public},ALL,"(EXISTS ( SELECT 1
   FROM admins
  WHERE ((admins.admin_id = auth.uid()) AND (admins.is_active = true))))",null
public,support_tickets,Admin read all tickets,PERMISSIVE,{public},SELECT,"(EXISTS ( SELECT 1
   FROM admins
  WHERE ((admins.admin_id = auth.uid()) AND (admins.is_active = true))))",null
public,support_tickets,Admin update ticket,PERMISSIVE,{public},UPDATE,"(EXISTS ( SELECT 1
   FROM admins
  WHERE ((admins.admin_id = auth.uid()) AND (admins.is_active = true))))",null
public,support_tickets,User can create ticket,PERMISSIVE,{public},INSERT,null,(user_id = auth.uid())
public,support_tickets,User can insert own tickets,PERMISSIVE,{public},INSERT,null,((user_id = auth.uid()) AND is_active_user())
public,support_tickets,User can read own tickets,PERMISSIVE,{public},SELECT,((user_id = auth.uid()) AND is_active_user()),null
public,support_tickets,User cannot update ticket,PERMISSIVE,{public},UPDATE,false,null
public,support_tickets,User create ticket,PERMISSIVE,{public},INSERT,null,(user_id = auth.uid())
public,usage_billing_period_stats,Service role can access usage stats,PERMISSIVE,{service_role},ALL,true,true
public,usage_daily_stats,Service role can access daily stats,PERMISSIVE,{service_role},ALL,true,true
public,user_deletion_logs,Admin read all deletion logs,PERMISSIVE,{public},SELECT,"(EXISTS ( SELECT 1
   FROM admins
  WHERE ((admins.admin_id = auth.uid()) AND (admins.is_active = true))))",null
public,user_deletion_logs,No direct insert to deletion logs,PERMISSIVE,{public},INSERT,null,false
public,user_deletion_logs,User can read own deletion logs,PERMISSIVE,{public},SELECT,(user_id = auth.uid()),null
public,user_subscriptions,Service role can access all subscriptions,PERMISSIVE,{service_role},ALL,true,true
public,users,Anyone can insert users,PERMISSIVE,{public},INSERT,null,true
public,users,Service role can access all users,PERMISSIVE,{service_role},ALL,true,true
public,users,Users can update their own data,PERMISSIVE,{public},UPDATE,((auth.uid() = user_id) AND (is_deleted = false)),null
public,users,Users can view their own data,PERMISSIVE,{public},SELECT,((auth.uid() = user_id) AND (is_deleted = false)),null
public,users,users_insert_self,PERMISSIVE,{public},INSERT,null,(user_id = auth.uid())
public,users,users_no_delete,PERMISSIVE,{public},DELETE,false,null
public,users,users_select_self,PERMISSIVE,{public},SELECT,((user_id = auth.uid()) AND (is_deleted = false)),null
public,users,users_update_self,PERMISSIVE,{public},UPDATE,((user_id = auth.uid()) AND (is_deleted = false)),((user_id = auth.uid()) AND (is_deleted = false))